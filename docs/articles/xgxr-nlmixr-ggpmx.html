<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>xgxr nlmixr and ggPmx integration • nlmixr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="xgxr nlmixr and ggPmx integration">
<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">nlmixr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa fas fa-book"></span>
     
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="divider">
    <li class="dropdown-header">Getting started</li>
    <li>
      <a href="../articles/running_nlmixr.html">Introduction to Running Nlmixr</a>
    </li>
    <li>
      <a href="../articles/multiple-endpoints.html">Using Multiple Endpoints in Nlmixr</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Going further</li>
    <li>
      <a href="../articles/modelPiping.html">Model Piping</a>
    </li>
    <li>
      <a href="../articles/broom.html">Sweeping models to tidy datasets (broom)</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/xgxr-nlmixr-ggpmx.html">Integrated development with xgxr/nlmixr/ggPMX</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa fas fa-chalkboard-teacher"></span>
     
    Example models
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/addingCovariances.html">Phenobarbatol with correlations</a>
    </li>
    <li class="divider">
    <li>
      <a href="https://nlmixrdevelopment.github.io/nlmixr.examples/articles/nimo.html">Nonlinear PK/PD -- Nimotuzumab</a>
    </li>
    <li>
      <a href="https://nlmixrdevelopment.github.io/nlmixr.examples/articles/mavoglurant.html">PBPK -- Mavoglurant</a>
    </li>
    <li>
      <a href="https://nlmixrdevelopment.github.io/nlmixr.examples/articles/wbc.html">PKPD -- Myelosuppression model</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://github.com/nlmixrdevelopment/nlmixr/raw/master/CheatSheet_nlmixr.pdf">
    <span class="fa fa-scroll fa-lg"></span>
     
    Cheat Sheet
  </a>
</li>
<li>
  <a href="https://doi.org/10.1002/psp4.12445">
    <span class="fas fa fas fa-life-ring"></span>
     
    Tutorial
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-file-code-o fa-lg"></span>
     
    Functions
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/nlmixrdevelopment/nlmixr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/nlmixrdevelopment/nlmixr/releases">
    <span class="fa fa-download"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>xgxr nlmixr and ggPmx integration</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/nlmixrdevelopment/nlmixr/blob/master/inst/vignettes/xgxr-nlmixr-ggpmx.Rmd"><code>inst/vignettes/xgxr-nlmixr-ggpmx.Rmd</code></a></small>
      <div class="hidden name"><code>xgxr-nlmixr-ggpmx.Rmd</code></div>

    </div>

    
    
<p>This shows an example of integrated workflow between <code>xgxr</code> <code>nlmixr</code> and <code>ggPmx</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(nlmixr)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(xgxr)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(readr)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ggplot2)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(dplyr)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(tidyr)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ggPMX)</code></pre></div>
<div id="load-the-data" class="section level1">
<h1 class="hasAnchor">
<a href="#load-the-data" class="anchor"></a>Load the data</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pkpd_data &lt;-<span class="st"> </span>case1_pkpd <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span>(DOSE) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="op">-</span>IPRED) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">TRTACT_low2high =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(TRTACT, <span class="dt">levels =</span> <span class="kw"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(TRTACT)),
         <span class="dt">TRTACT_high2low =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(TRTACT, <span class="dt">levels =</span> <span class="kw"><a href="https://rdrr.io/r/base/rev.html">rev</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(TRTACT))),
         <span class="dt">DAY_label =</span> <span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"Day"</span>, PROFDAY),
         <span class="dt">DAY_label =</span> <span class="kw"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(DAY_label <span class="op">==</span><span class="st"> "Day 0"</span>,<span class="st">"Baseline"</span>,DAY_label))
 
pk_data &lt;-<span class="st"> </span>pkpd_data <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(CMT <span class="op">==</span><span class="st"> </span><span class="dv">2</span>)

pk_data_cycle1 &lt;-<span class="st"> </span>pk_data <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(CYCLE <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</code></pre></div>
</div>
<div id="exploratory-analysis-using-ggplot-and-xgx-helper-functions" class="section level1">
<h1 class="hasAnchor">
<a href="#exploratory-analysis-using-ggplot-and-xgx-helper-functions" class="anchor"></a>Exploratory analysis using ggplot and xgx helper functions</h1>
<div id="use-xgxr-for-simplified-concentration-over-time-colored-by-dose-mean---95-ci" class="section level2">
<h2 class="hasAnchor">
<a href="#use-xgxr-for-simplified-concentration-over-time-colored-by-dose-mean---95-ci" class="anchor"></a>Use xgxr for simplified concentration over time, colored by Dose, mean +/- 95% CI</h2>
<p>Often in exploring data it is worthwhile to plot by dose by each nominal time and add the 95% confidence interval. This typical plot can be cumbersome and lack some nice features that <code>xgxr</code> can help with. Note the following helper functions:</p>
<ul>
<li><p><code><a href="https://rdrr.io/pkg/xgxr/man/xgx_theme_set.html">xgx_theme_set()</a></code> this sets the theme to black and white color theme and other best pratices in <code>xgxr</code>.</p></li>
<li><p><code><a href="https://rdrr.io/pkg/xgxr/man/xgx_geom_ci.html">xgx_geom_ci()</a></code> which creates the Confidence Interval and mean plots in a simple interface.</p></li>
<li><p><code><a href="https://rdrr.io/pkg/xgxr/man/xgx_scale_y_log10.html">xgx_scale_y_log10()</a></code> which creates a log-scale that includes the minor grids that immediately show the viewer that the plot is a semi-log plot without carefully examining the y axis.</p></li>
<li><p><code><a href="https://rdrr.io/pkg/xgxr/man/xgx_scale_x_time_units.html">xgx_scale_x_time_units()</a></code> which creates an appropriate scale based on your times observed and the units you use. It also allows you to convert units easily for the right display.</p></li>
<li><p><code>xgx_annote_status()</code> which adds a <code>DRAFT</code> annotation which is often considered best practice when the data or plots are draft.</p></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/pkg/xgxr/man/xgx_theme_set.html">xgx_theme_set</a></span>() <span class="co"># This uses black and white theme based on xgxr best</span>
                <span class="co"># pratices</span>

<span class="co"># flag for labeling figures as draft</span>
status &lt;-<span class="st"> "DRAFT"</span>

time_units_dataset &lt;-<span class="st"> "hours"</span>
time_units_plot    &lt;-<span class="st"> "days"</span>
trtact_label       &lt;-<span class="st"> "Dose"</span>
dose_label         &lt;-<span class="st"> "Dose (mg)"</span>
conc_label         &lt;-<span class="st"> "Concentration (ng/ml)"</span> 
auc_label          &lt;-<span class="st"> "AUCtau (h.(ng/ml))"</span>
concnorm_label     &lt;-<span class="st"> "Normalized Concentration (ng/ml)/mg"</span>
sex_label          &lt;-<span class="st"> "Sex"</span>
w100_label         &lt;-<span class="st"> "WEIGHTB&gt;100"</span>
pd_label           &lt;-<span class="st"> "FEV1 (mL)"</span>
cens_label         &lt;-<span class="st"> "Censored"</span>


<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="dt">data =</span> pk_data_cycle1, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x     =</span> NOMTIME,
                                  <span class="dt">y     =</span> LIDV,
                                  <span class="dt">group =</span> DOSE,
                                  <span class="dt">color =</span> TRTACT_high2low)) <span class="op">+</span>
<span class="st">    </span><span class="kw"><a href="https://rdrr.io/pkg/xgxr/man/xgx_geom_ci.html">xgx_geom_ci</a></span>(<span class="dt">conf_level =</span> <span class="fl">0.95</span>) <span class="op">+</span><span class="st"> </span><span class="co"># Easy CI with xgxr</span>
<span class="st">    </span><span class="kw"><a href="https://rdrr.io/pkg/xgxr/man/xgx_scale_y_log10.html">xgx_scale_y_log10</a></span>() <span class="op">+</span><span class="st"> </span><span class="co"># semi-log plots with semi-log grid minor lines</span>
<span class="st">    </span><span class="kw"><a href="https://rdrr.io/pkg/xgxr/man/xgx_scale_x_time_units.html">xgx_scale_x_time_units</a></span>(<span class="dt">units_dataset =</span> time_units_dataset,
                           <span class="dt">units_plot =</span> time_units_plot) <span class="op">+</span>
<span class="st">    </span><span class="co"># The last line creates an appropriate x scale based on time-units</span>
<span class="st">    </span><span class="co"># and time unit scale</span>
<span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">y =</span> conc_label, <span class="dt">color =</span> trtact_label) <span class="op">+</span>
<span class="st">    </span><span class="kw"><a href="https://rdrr.io/pkg/xgxr/man/xgx_annotate_status.html">xgx_annotate_status</a></span>(status) <span class="co">#  Adds draft status to plot</span></code></pre></div>
<p><img src="xgxr-nlmixr-ggpmx_files/figure-html/unnamed-chunk-3-1.png" width="100%"></p>
<p>With this plot you see the mean concentrations confidence intervals stratified by dose</p>
</div>
<div id="concentration-over-time-faceted-by-dose-mean---95-ci-overlaid-on-gray-spaghetti-plots" class="section level2">
<h2 class="hasAnchor">
<a href="#concentration-over-time-faceted-by-dose-mean---95-ci-overlaid-on-gray-spaghetti-plots" class="anchor"></a>Concentration over time, faceted by Dose, mean +/- 95% CI, overlaid on gray spaghetti plots</h2>
<p>Not only is it useful to look at the mean concentrations, it is often useful to look at the mean concentrations and their relationship between actual individual profiles. Using <code>ggplot</code> coupled with the <code>xgxr</code> helper functions used above, we can easily create these plots as well:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="dt">data =</span> pk_data_cycle1, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> NOMTIME, <span class="dt">y =</span> LIDV)) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">group =</span> ID), <span class="dt">color =</span> <span class="kw"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">alpha =</span> <span class="fl">0.3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_shape_manual</a></span>(<span class="dt">values =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="dv">8</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span>(<span class="dt">values =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"grey50"</span>, <span class="st">"red"</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/xgxr/man/xgx_geom_ci.html">xgx_geom_ci</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> NOMTIME, <span class="dt">color =</span> <span class="ot">NULL</span>, <span class="dt">group =</span> <span class="ot">NULL</span>), <span class="dt">conf_level =</span> <span class="fl">0.95</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/xgxr/man/xgx_scale_y_log10.html">xgx_scale_y_log10</a></span>() <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/xgxr/man/xgx_scale_x_time_units.html">xgx_scale_x_time_units</a></span>(<span class="dt">units_dataset =</span> time_units_dataset, <span class="dt">units_plot =</span> time_units_plot) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">y =</span> conc_label, <span class="dt">color =</span> trtact_label) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="dt">legend.position =</span> <span class="st">"none"</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span>(.<span class="op">~</span>TRTACT_low2high) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/xgxr/man/xgx_annotate_status.html">xgx_annotate_status</a></span>(status)</code></pre></div>
<p><img src="xgxr-nlmixr-ggpmx_files/figure-html/unnamed-chunk-4-1.png" width="100%"></p>
<p>To me it appears the variability seems to be higher with higher doses and higher with later times.</p>
</div>
<div id="exploring-the-dose-linearity" class="section level2">
<h2 class="hasAnchor">
<a href="#exploring-the-dose-linearity" class="anchor"></a>Exploring the dose linearity</h2>
<p>A common way to explore the dose linearity is to normalize by the dose. If the confidence intervals overlap, often this is a dose linear example.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="dt">data =</span> pk_data_cycle1,
       <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> NOMTIME,
           <span class="dt">y =</span> LIDV <span class="op">/</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(DOSE)),
           <span class="dt">group =</span> DOSE,
           <span class="dt">color =</span> TRTACT_high2low)) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/xgxr/man/xgx_geom_ci.html">xgx_geom_ci</a></span>(<span class="dt">conf_level =</span> <span class="fl">0.95</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>, <span class="dt">position =</span> <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span>(<span class="dv">1</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/xgxr/man/xgx_scale_y_log10.html">xgx_scale_y_log10</a></span>() <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/xgxr/man/xgx_scale_x_time_units.html">xgx_scale_x_time_units</a></span>(<span class="dt">units_dataset =</span> time_units_dataset, <span class="dt">units_plot =</span> time_units_plot) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">y =</span> concnorm_label, <span class="dt">color =</span> trtact_label) <span class="op">+</span>
<span class="st">    </span><span class="kw"><a href="https://rdrr.io/pkg/xgxr/man/xgx_annotate_status.html">xgx_annotate_status</a></span>(status)</code></pre></div>
<p><img src="xgxr-nlmixr-ggpmx_files/figure-html/unnamed-chunk-5-1.png" width="100%"></p>
<p>This example seems to be dose-linear, with the exception of the censored data. This can be made even more clear by removing the censored data for this plot:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="dt">data =</span> pk_data_cycle1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(CENS <span class="op">==</span><span class="st"> </span><span class="dv">0</span>),
       <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> NOMTIME,
           <span class="dt">y =</span> LIDV <span class="op">/</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(DOSE)),
           <span class="dt">group =</span> DOSE,
           <span class="dt">color =</span> TRTACT_high2low)) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/xgxr/man/xgx_geom_ci.html">xgx_geom_ci</a></span>(<span class="dt">conf_level =</span> <span class="fl">0.95</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>, <span class="dt">position =</span> <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span>(<span class="dv">1</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/xgxr/man/xgx_scale_y_log10.html">xgx_scale_y_log10</a></span>() <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/xgxr/man/xgx_scale_x_time_units.html">xgx_scale_x_time_units</a></span>(<span class="dt">units_dataset =</span> time_units_dataset, <span class="dt">units_plot =</span> time_units_plot) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">y =</span> concnorm_label, <span class="dt">color =</span> trtact_label) <span class="op">+</span>
<span class="st">    </span><span class="kw"><a href="https://rdrr.io/pkg/xgxr/man/xgx_annotate_status.html">xgx_annotate_status</a></span>(status)</code></pre></div>
<p><img src="xgxr-nlmixr-ggpmx_files/figure-html/unnamed-chunk-6-1.png" width="100%"></p>
<p>The lowest dose, with the most censoring, is the one that seems to be the outlier. That is likely an artifact of censoring.</p>
<p>Other ways to explore the data include by looking at normalized Cmax and AUC values (which we will skip in this vignette).</p>
</div>
</div>
<div id="exploring-covariates-in-the-dataset" class="section level1">
<h1 class="hasAnchor">
<a href="#exploring-covariates-in-the-dataset" class="anchor"></a>Exploring Covariates in the dataset</h1>
<p>Using the <code>xgx</code> helper functions to <code>ggplot</code> you can explore the effect of high baseline weight. This particular plot is shown below:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="dt">data =</span> pk_data_cycle1, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> NOMTIME,
                                  <span class="dt">y =</span> LIDV,
                                  <span class="dt">group =</span> WEIGHTB <span class="op">&gt;</span><span class="st"> </span><span class="dv">100</span>,
                                  <span class="dt">color =</span> WEIGHTB <span class="op">&gt;</span><span class="st"> </span><span class="dv">100</span>)) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="https://rdrr.io/pkg/xgxr/man/xgx_geom_ci.html">xgx_geom_ci</a></span>(<span class="dt">conf_level =</span> <span class="fl">0.95</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw"><a href="https://rdrr.io/pkg/xgxr/man/xgx_scale_y_log10.html">xgx_scale_y_log10</a></span>() <span class="op">+</span>
<span class="st">    </span><span class="kw"><a href="https://rdrr.io/pkg/xgxr/man/xgx_scale_x_time_units.html">xgx_scale_x_time_units</a></span>(<span class="dt">units_dataset =</span> time_units_dataset, <span class="dt">units_plot =</span> time_units_plot) <span class="op">+</span>
<span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span>(.<span class="op">~</span>DOSE) <span class="op">+</span>
<span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">y =</span> conc_label, <span class="dt">color =</span> w100_label) <span class="op">+</span>
<span class="st">    </span><span class="kw"><a href="https://rdrr.io/pkg/xgxr/man/xgx_annotate_status.html">xgx_annotate_status</a></span>(status)</code></pre></div>
<p><img src="xgxr-nlmixr-ggpmx_files/figure-html/unnamed-chunk-7-1.png" width="100%"> It seems that the weight effect is not extreme for either dose group</p>
<div id="summary-of-exploratory-analysis-findings" class="section level2">
<h2 class="hasAnchor">
<a href="#summary-of-exploratory-analysis-findings" class="anchor"></a>Summary of exploratory analysis findings</h2>
<p>From the exploratory analysis we see: - The doses seem proportional - The PK seems to have a 2-compartment model - Censoring has a large effect on the PK data.</p>
</div>
</div>
<div id="fitting-the-data-with-nlmixr" class="section level1">
<h1 class="hasAnchor">
<a href="#fitting-the-data-with-nlmixr" class="anchor"></a>Fitting the data with nlmixr</h1>
<p>First we need to subset to the PK only data and rename <code>LIDV</code> to <code>DV</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat &lt;-<span class="st"> </span>case1_pkpd <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">rename</a></span>(<span class="dt">DV=</span>LIDV) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(CMT <span class="op">%in%</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">2</span>) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="co"># Filter (for now) since CENS supprot in nlmixr is in development</span>
<span class="st">    </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(CENS <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(TRTACT <span class="op">!=</span><span class="st"> "Placebo"</span>)</code></pre></div>
<p>Next create a 2 compartment model:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
## Use 2 compartment model
cmt2 &lt;-<span class="st"> </span><span class="cf">function</span>(){
    <span class="kw"><a href="../reference/ini.html">ini</a></span>({
        lka &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="fl">0.1</span>) <span class="co"># log Ka</span>
        lv &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="dv">10</span>) <span class="co"># Log Vc</span>
        lcl &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="dv">4</span>) <span class="co"># Log Cl</span>
        lq &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="dv">10</span>) <span class="co"># log Q</span>
        lvp &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="dv">20</span>) <span class="co"># Log Vp</span>

        eta.ka <span class="op">~</span><span class="st"> </span><span class="fl">0.01</span>
        eta.v <span class="op">~</span><span class="st"> </span><span class="fl">0.1</span>
        eta.cl <span class="op">~</span><span class="st"> </span><span class="fl">0.1</span>
        logn.sd =<span class="st"> </span><span class="dv">10</span>
    })
    <span class="kw"><a href="../reference/model.html">model</a></span>({
        ka &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(lka <span class="op">+</span><span class="st"> </span>eta.ka)
        cl &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(lcl <span class="op">+</span><span class="st"> </span>eta.cl)
        v &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(lv <span class="op">+</span><span class="st"> </span>eta.v)
        q &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(lq)
        vp &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(lvp)
        <span class="kw">linCmt</span>() <span class="op">~</span><span class="st"> </span><span class="kw">lnorm</span>(logn.sd)
    })
}

## Check parsing
cmt2m &lt;-<span class="st"> </span><span class="kw"><a href="../reference/nlmixr.html">nlmixr</a></span>(cmt2)
<span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(cmt2m)
<span class="co">#&gt; ▂▂ RxODE-based 1-compartment model with first-order absorption ▂▂▂▂▂▂▂▂▂▂▂▂ </span>
<span class="co">#&gt; ── Initialization: ──────────────────────────────────────────────────────── </span>
<span class="co">#&gt; Fixed Effects ($theta): </span>
<span class="co">#&gt;       lka        lv       lcl        lq       lvp </span>
<span class="co">#&gt; -2.302585  2.302585  1.386294  2.302585  2.995732 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Omega ($omega): </span>
<span class="co">#&gt;        eta.ka eta.v eta.cl</span>
<span class="co">#&gt; eta.ka   0.01   0.0    0.0</span>
<span class="co">#&gt; eta.v    0.00   0.1    0.0</span>
<span class="co">#&gt; eta.cl   0.00   0.0    0.1</span>
<span class="co">#&gt; ── μ-referencing ($muRefTable): ─────────────────────────────────────────── </span>
<span class="co">#&gt; ┌─────────┬─────────┐</span>
<span class="co">#&gt; │ theta   │ eta     │</span>
<span class="co">#&gt; ├─────────┼─────────┤</span>
<span class="co">#&gt; │ lka     │ eta.ka  │</span>
<span class="co">#&gt; ├─────────┼─────────┤</span>
<span class="co">#&gt; │ lcl     │ eta.cl  │</span>
<span class="co">#&gt; ├─────────┼─────────┤</span>
<span class="co">#&gt; │ lv      │ eta.v   │</span>
<span class="co">#&gt; └─────────┴─────────┘</span>
<span class="co">#&gt; ── Model: ───────────────────────────────────────────────────────────────── </span>
<span class="co">#&gt;         ka &lt;- exp(lka + eta.ka)</span>
<span class="co">#&gt;         cl &lt;- exp(lcl + eta.cl)</span>
<span class="co">#&gt;         v &lt;- exp(lv + eta.v)</span>
<span class="co">#&gt;         q &lt;- exp(lq)</span>
<span class="co">#&gt;         vp &lt;- exp(lvp)</span>
<span class="co">#&gt;         linCmt() ~ lnorm(logn.sd) </span>
<span class="co">#&gt; ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## First try log-normal (since the variabilitiy seemed proportional to concentration)
cmt2fit.logn &lt;-<span class="st"> </span><span class="kw"><a href="../reference/nlmixr.html">nlmixr</a></span>(cmt2m, dat, <span class="st">"saem"</span>, <span class="dt">table=</span><span class="kw"><a href="../reference/tableControl.html">tableControl</a></span>(<span class="dt">npde=</span><span class="ot">TRUE</span>,<span class="dt">cwres=</span><span class="ot">TRUE</span>))


## Now try proportional
cmt2fit.prop &lt;-<span class="st"> </span>cmt2fit.logn <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw"><a href="https://rdrr.io/r/stats/update.html">update</a></span>(<span class="kw">linCmt</span>() <span class="op">~</span><span class="st"> </span><span class="kw">prop</span>(prop.sd)) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw"><a href="../reference/nlmixr.html">nlmixr</a></span>(<span class="dt">est=</span><span class="st">"saem"</span>, <span class="dt">table=</span><span class="kw"><a href="../reference/tableControl.html">tableControl</a></span>(<span class="dt">npde=</span><span class="ot">TRUE</span>, <span class="dt">cwres=</span><span class="ot">TRUE</span>))

## now try add+prop
cmt2fit.add.prop &lt;-<span class="st"> </span>cmt2fit.prop <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw"><a href="https://rdrr.io/r/stats/update.html">update</a></span>(<span class="kw">linCmt</span>() <span class="op">~</span><span class="st"> </span><span class="kw">prop</span>(prop.sd) <span class="op">+</span><span class="st"> </span><span class="kw">add</span>(add.sd)) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw"><a href="../reference/nlmixr.html">nlmixr</a></span>(<span class="dt">est=</span><span class="st">"saem"</span>, <span class="dt">table=</span><span class="kw"><a href="../reference/tableControl.html">tableControl</a></span>(<span class="dt">npde=</span><span class="ot">TRUE</span>, <span class="dt">cwres=</span><span class="ot">TRUE</span>))</code></pre></div>
<p>Now that we have run 3 different estimation methods, we can compare the results side-by-side</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(huxtable)

<span class="kw"><a href="https://rdrr.io/pkg/huxtable/man/as_huxtable.html">as_hux</a></span>(<span class="st">"lognormal"</span>=cmt2fit.logn, <span class="st">"proportional"</span>=cmt2fit.prop, <span class="st">"add+prop"</span>=cmt2fit.add.prop)</code></pre></div>
<table class="table huxtable">
<col>
<col>
<col>
<col>
<tr>
<td style="vertical-align: top; text-align: center; white-space: nowrap; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0pt 0pt; padding: 4pt 4pt 4pt 4pt;"></td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt;">lognormal</td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt;">proportional</td>
<td style="vertical-align: top; text-align: center; white-space: nowrap; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt;">add+prop</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">lka</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">-0.998    </td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">-0.992    </td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">-0.983    </td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;"></td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">(0.054)   </td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">(0.052)   </td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">(0.052)   </td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">lv</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">2.469 ***</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">2.448 ***</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">2.461 ***</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;"></td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">(0.056)   </td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">(0.049)   </td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">(0.049)   </td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">lcl</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">2.553 ***</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">2.509 ***</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">2.511 ***</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;"></td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">(0.047)   </td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">(0.047)   </td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">(0.047)   </td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">lq</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">2.376 ***</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">2.293 ***</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">2.299 ***</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;"></td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">(0.040)   </td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">(0.035)   </td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">(0.036)   </td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">lvp</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">5.176 ***</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">5.110 ***</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">5.100 ***</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;"></td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">(0.038)   </td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">(0.034)   </td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">(0.034)   </td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">sd__eta.ka</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">0.447    </td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">0.452    </td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">0.450    </td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">sd__eta.v</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">0.203    </td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">0.169    </td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">0.151    </td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">sd__eta.cl</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">0.500    </td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">0.500    </td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">0.500    </td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">logn.sd</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">0.320    </td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">        </td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">        </td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">prop.sd</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">        </td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">0.283    </td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">0.283    </td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">add.sd</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">        </td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">        </td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">0.000    </td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">N</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">2207        </td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">2207        </td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">2207        </td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">Objective Function</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">-6533.378    </td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">-6730.322    </td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">-6730.371    </td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">logLik</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">1492.219    </td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">1590.691    </td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt;">1590.715    </td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt; padding: 4pt 4pt 4pt 4pt;">AIC</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt; padding: 4pt 4pt 4pt 4pt;">-2966.438    </td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt; padding: 4pt 4pt 4pt 4pt;">-3163.382    </td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt; padding: 4pt 4pt 4pt 4pt;">-3161.430    </td>
</tr>
<tr>
<td colspan="4" style="vertical-align: top; text-align: left; white-space: normal; padding: 4pt 4pt 4pt 4pt;"> *** p &lt; 0.001;  ** p &lt; 0.01;  * p &lt; 0.05.</td>
</tr>
</table>
<p>Note that the additive and proportional model has the additive component approach zero. When comparing the objective functions of log-normal and proportional models, the proportional model has the lowest objective function value. (Since we modeled log-normal without data transformation it is appropriate to compare the AIC/Objective function values)</p>
<p>You may wish to see a visual comparison of the parameters:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(dotwhisker)
## exponentiate=NA causes the parameters to be back-transformed
<span class="kw"><a href="https://rdrr.io/pkg/dotwhisker/man/dwplot.html">dwplot</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"lognormal"</span>=cmt2fit.logn, <span class="st">"proportional"</span>=cmt2fit.prop), <span class="dt">exponentiate=</span><span class="ot">NA</span>) <span class="op">+</span>
<span class="st">    </span>## Notice we can use some xgx functions post analysis as well,
<span class="st">    </span>## since they are ggplot helper functions
<span class="st">    </span><span class="kw"><a href="https://rdrr.io/pkg/xgxr/man/xgx_scale_x_log10.html">xgx_scale_x_log10</a></span>() <span class="op">+</span>
<span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"Comparison between lognormal and proportional models"</span>,
            <span class="st">"On backtransformed scales"</span>)</code></pre></div>
<p><img src="xgxr-nlmixr-ggpmx_files/figure-html/unnamed-chunk-12-1.png" width="100%"></p>
</div>
<div id="model-diagnostics-with-ggpmx" class="section level1">
<h1 class="hasAnchor">
<a href="#model-diagnostics-with-ggpmx" class="anchor"></a>Model Diagnostics with ggPMX</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## The controller then can be piped into a specific plot
ctr &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/ggPMX/man/pmx_nlmixr.html">pmx_nlmixr</a></span>(cmt2fit.logn, <span class="dt">conts =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"WEIGHTB"</span>), <span class="dt">cats=</span><span class="st">"TRTACT"</span>)

ctr <span class="op">%&gt;%</span><span class="st"> </span>pmx_plot_dv_ipred</code></pre></div>
<p><img src="xgxr-nlmixr-ggpmx_files/figure-html/unnamed-chunk-13-1.png" width="100%"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
ctr <span class="op">%&gt;%</span><span class="st"> </span>pmx_plot_dv_pred</code></pre></div>
<p><img src="xgxr-nlmixr-ggpmx_files/figure-html/unnamed-chunk-13-2.png" width="100%"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
ctr <span class="op">%&gt;%</span><span class="st"> </span>pmx_plot_abs_iwres_ipred</code></pre></div>
<p><img src="xgxr-nlmixr-ggpmx_files/figure-html/unnamed-chunk-13-3.png" width="100%"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
## For this display only show 1x1 individual plot for ID 110 for time &lt; 12
ctr <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/ggPMX/man/pmx_plot_individual.html">pmx_plot_individual</a></span>(<span class="dv">1</span>, <span class="dt">filter=</span>ID <span class="op">==</span><span class="st"> </span><span class="dv">110</span> <span class="op">&amp;</span><span class="st"> </span>TIME <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>TIME <span class="op">&lt;</span><span class="st"> </span><span class="dv">12</span>, 
                            <span class="dt">facets =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">nrow =</span> <span class="dv">1</span>, <span class="dt">ncol =</span> <span class="dv">1</span>))</code></pre></div>
<p><img src="xgxr-nlmixr-ggpmx_files/figure-html/unnamed-chunk-13-4.png" width="100%"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
ctr <span class="op">%&gt;%</span><span class="st"> </span>pmx_plot_iwres_dens</code></pre></div>
<p><img src="xgxr-nlmixr-ggpmx_files/figure-html/unnamed-chunk-13-5.png" width="100%"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
ctr <span class="op">%&gt;%</span><span class="st"> </span>pmx_plot_npde_qq</code></pre></div>
<p><img src="xgxr-nlmixr-ggpmx_files/figure-html/unnamed-chunk-13-6.png" width="100%"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
ctr <span class="op">%&gt;%</span><span class="st"> </span>pmx_plot_npde_pred</code></pre></div>
<p><img src="xgxr-nlmixr-ggpmx_files/figure-html/unnamed-chunk-13-7.png" width="100%"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
ctr <span class="op">%&gt;%</span><span class="st"> </span>pmx_plot_npde_time</code></pre></div>
<p><img src="xgxr-nlmixr-ggpmx_files/figure-html/unnamed-chunk-13-8.png" width="100%"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
ctr <span class="op">%&gt;%</span><span class="st"> </span>pmx_plot_eta_qq</code></pre></div>
<p><img src="xgxr-nlmixr-ggpmx_files/figure-html/unnamed-chunk-13-9.png" width="100%"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
## 0-12 hour VPC on semi-log scale
ctr <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/ggPMX/man/pmx_plot_vpc.html">pmx_plot_vpc</a></span>(<span class="dt">filter=</span>TIME <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>TIME <span class="op">&lt;</span><span class="st"> </span><span class="dv">12</span>,
                     <span class="dt">scale_y_log10=</span><span class="ot">TRUE</span>, 
                     <span class="dt">bin=</span><span class="kw"><a href="https://rdrr.io/pkg/ggPMX/man/pmx_vpc_bin.html">pmx_vpc_bin</a></span>(<span class="st">"jenks"</span>,<span class="dt">n=</span><span class="dv">5</span>))</code></pre></div>
<p><img src="xgxr-nlmixr-ggpmx_files/figure-html/unnamed-chunk-13-10.png" width="100%"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
## 0-12 hour VPC on linear scale
ctr <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/ggPMX/man/pmx_plot_vpc.html">pmx_plot_vpc</a></span>(<span class="dt">filter=</span>TIME <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>TIME <span class="op">&lt;</span><span class="st"> </span><span class="dv">12</span>,
                     <span class="dt">scale_y_log10=</span><span class="ot">FALSE</span>, 
                     <span class="dt">bin=</span><span class="kw"><a href="https://rdrr.io/pkg/ggPMX/man/pmx_vpc_bin.html">pmx_vpc_bin</a></span>(<span class="st">"jenks"</span>,<span class="dt">n=</span><span class="dv">5</span>))</code></pre></div>
<p><img src="xgxr-nlmixr-ggpmx_files/figure-html/unnamed-chunk-13-11.png" width="100%"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
ctr <span class="op">%&gt;%</span><span class="st"> </span>pmx_plot_eta_box</code></pre></div>
<p><img src="xgxr-nlmixr-ggpmx_files/figure-html/unnamed-chunk-13-12.png" width="100%"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
ctr <span class="op">%&gt;%</span><span class="st"> </span>pmx_plot_eta_hist</code></pre></div>
<p><img src="xgxr-nlmixr-ggpmx_files/figure-html/unnamed-chunk-13-13.png" width="100%"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
ctr <span class="op">%&gt;%</span><span class="st"> </span>pmx_plot_eta_matrix</code></pre></div>
<p><img src="xgxr-nlmixr-ggpmx_files/figure-html/unnamed-chunk-13-14.png" width="100%"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
## Create a report of all the plots you generated from the controller
<span class="cf">if</span> (<span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/files.html">file.exists</a></span>(<span class="st">"nlmixr_report.docx"</span>)){
    ctr <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/ggPMX/man/pmx_report.html">pmx_report</a></span>(<span class="st">"nlmixr_report"</span>,<span class="st">"."</span>)
}
<span class="cf">if</span> (<span class="kw"><a href="https://rdrr.io/r/base/files.html">file.exists</a></span>(<span class="st">"nlmixr_report.Rmd"</span>))
    <span class="kw"><a href="https://rdrr.io/r/base/unlink.html">unlink</a></span>(<span class="st">"nlmixr_report.Rmd"</span>) <span class="co"># Remove this file so it isn't confused with vignettes</span></code></pre></div>
<p>This creates 2 reports, both a <a href="https://github.com/nlmixrdevelopment/nlmixr/raw/master/vignettes/nlmixr_report.pdf">pdf</a> and <a href="https://github.com/nlmixrdevelopment/nlmixr/raw/master/vignettes/nlmixr_report.docx">word</a> document.</p>
</div>
<div id="simulation-of-a-new-scenario-with-rxode" class="section level1">
<h1 class="hasAnchor">
<a href="#simulation-of-a-new-scenario-with-rxode" class="anchor"></a>Simulation of a new scenario with RxODE</h1>
<p>By creating events you can simply simulate a new scenario. Perhaps your drug development team wants to explore the 100 mg dose 3 times a day dosing to see what happens with the PK. You can simply simulate from the nlmixr model using a <a href="https://nlmixrdevelopment.github.io/RxODE/articles/RxODE-event-table.html">new event table</a> created from RxODE.</p>
<p>In this case we wish to simulate with some variability and see what happens at steady state:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(ev &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/RxODE/man/et.html">et</a></span>(<span class="dt">amt=</span><span class="dv">100</span>, <span class="dt">ii=</span><span class="dv">8</span>, <span class="dt">ss=</span><span class="dv">1</span>))
<span class="co">#&gt; ──────────────────────── EventTable with 1 records ────────────────────────</span>
<span class="co">#&gt;    1 dosing records (see x$get.dosing(); add with add.dosing or et)</span>
<span class="co">#&gt;    0 observation times (see x$get.sampling(); add with add.sampling or et)</span>
<span class="co">#&gt; ── First part of x: ───────────────────────────────────────────────────────</span>
<span class="co">#&gt; # A tibble: 1 x 5</span>
<span class="co">#&gt;    time   amt    ii evid            ss</span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;evid&gt;       &lt;int&gt;</span>
<span class="co">#&gt; 1     0   100     8 1:Dose (Add)     1</span>
<span class="co">#&gt; ───────────────────────────────────────────────────────────────────────────</span>

ev<span class="op">$</span><span class="kw"><a href="https://rdrr.io/pkg/RxODE/man/add.sampling.html">add.sampling</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>, <span class="dv">8</span>, <span class="dt">length.out=</span><span class="dv">100</span>))
<span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(ev)
<span class="co">#&gt; ─────────────────────── EventTable with 101 records ───────────────────────</span>
<span class="co">#&gt;    1 dosing records (see $get.dosing(); add with add.dosing or et)</span>
<span class="co">#&gt;    100 observation times (see $get.sampling(); add with add.sampling or et)</span>
<span class="co">#&gt; ── First part of : ────────────────────────────────────────────────────────</span>
<span class="co">#&gt; # A tibble: 101 x 5</span>
<span class="co">#&gt;      time   amt    ii evid             ss</span>
<span class="co">#&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;evid&gt;        &lt;int&gt;</span>
<span class="co">#&gt;  1 0         NA    NA 0:Observation    NA</span>
<span class="co">#&gt;  2 0        100     8 1:Dose (Add)      1</span>
<span class="co">#&gt;  3 0.0808    NA    NA 0:Observation    NA</span>
<span class="co">#&gt;  4 0.162     NA    NA 0:Observation    NA</span>
<span class="co">#&gt;  5 0.242     NA    NA 0:Observation    NA</span>
<span class="co">#&gt;  6 0.323     NA    NA 0:Observation    NA</span>
<span class="co">#&gt;  7 0.404     NA    NA 0:Observation    NA</span>
<span class="co">#&gt;  8 0.485     NA    NA 0:Observation    NA</span>
<span class="co">#&gt;  9 0.566     NA    NA 0:Observation    NA</span>
<span class="co">#&gt; 10 0.646     NA    NA 0:Observation    NA</span>
<span class="co">#&gt; # … with 91 more rows</span>
<span class="co">#&gt; ───────────────────────────────────────────────────────────────────────────</span></code></pre></div>
<p>A nlmixr model already includes information about the parameter estimates and can simulate without uncertainty in the population parameters or covariances, like what is done for a VPC.</p>
<p>If you wish to simulate <code>100</code> patients repeated by <code>100</code> different theoretical studies where you simulate from the uncertainty in the fixed parameter estimates and covariances you can very easily with nlmixr/RxODE:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">100</span>)
sim1 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/simulate.html">simulate</a></span>(cmt2fit.logn, <span class="dt">events=</span>ev, <span class="dt">nSub=</span><span class="dv">100</span>, <span class="dt">nStud=</span><span class="dv">100</span>)
<span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====</span>

<span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(sim1)
<span class="co">#&gt; ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂ Solved RxODE object ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂</span>
<span class="co">#&gt; ── Initial Conditions ($inits): ───────────────────────────────────────────</span>
<span class="co">#&gt;      depot    central peripheral </span>
<span class="co">#&gt;          0          0          0 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Simulation with uncertainty in:</span>
<span class="co">#&gt;   - parameters ($thetaMat for changes)</span>
<span class="co">#&gt;   - omega matrix ($omegaList)</span>
<span class="co">#&gt;   - sigma matrix ($sigmaList)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── First part of data (object): ───────────────────────────────────────────</span>
<span class="co">#&gt; # A tibble: 1,000,000 x 7</span>
<span class="co">#&gt;   sim.id   time ipred   sim depot central peripheral</span>
<span class="co">#&gt;    &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt;</span>
<span class="co">#&gt; 1      1 0      0.250 0.331 102.     1.96       105.</span>
<span class="co">#&gt; 2      1 0.0808 0.691 0.797  97.6    5.41       105.</span>
<span class="co">#&gt; 3      1 0.162  0.995 0.852  93.7    7.79       105.</span>
<span class="co">#&gt; 4      1 0.242  1.20  0.772  89.9    9.39       106.</span>
<span class="co">#&gt; 5      1 0.323  1.33  1.42   86.2   10.4        106.</span>
<span class="co">#&gt; 6      1 0.404  1.41  1.10   82.7   11.1        107.</span>
<span class="co">#&gt; # … with 999,994 more rows</span>
<span class="co">#&gt; ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂</span></code></pre></div>
<p>You may examine the simulated study information easily, as show in the <code>RxODE</code> printout:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(sim1<span class="op">$</span>thetaMat)
<span class="co">#&gt;              lka           lv          lcl          lq           lvp</span>
<span class="co">#&gt; [1,] -0.01043193 -0.007611034 -0.053051023  0.02345737  0.0002913503</span>
<span class="co">#&gt; [2,] -0.01857990 -0.093889352 -0.050334923 -0.04110705  0.0198110505</span>
<span class="co">#&gt; [3,] -0.05901739 -0.010213278 -0.002949055  0.01338986  0.0921800430</span>
<span class="co">#&gt; [4,]  0.12315772  0.122623690  0.033201070  0.04442167 -0.0595848069</span>
<span class="co">#&gt; [5,] -0.03469916 -0.046088903 -0.016364821 -0.03015755  0.0147288196</span>
<span class="co">#&gt; [6,]  0.02872446  0.074789590 -0.080679098 -0.05292902 -0.0339947624</span></code></pre></div>
<p>You can also see the covariance matricies that are simulated (note they come from an inverse Wishart distribution):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(sim1<span class="op">$</span>omegaList)
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt;             [,1]         [,2]         [,3]</span>
<span class="co">#&gt; [1,] 0.218066183  0.002324327  0.012238585</span>
<span class="co">#&gt; [2,] 0.002324327  0.042358385 -0.006852241</span>
<span class="co">#&gt; [3,] 0.012238585 -0.006852241  0.285765709</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt;              [,1]         [,2]         [,3]</span>
<span class="co">#&gt; [1,]  0.223865146 -0.004857413  0.018191272</span>
<span class="co">#&gt; [2,] -0.004857413  0.039843927 -0.009079676</span>
<span class="co">#&gt; [3,]  0.018191272 -0.009079676  0.236035903</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[3]]</span>
<span class="co">#&gt;             [,1]         [,2]         [,3]</span>
<span class="co">#&gt; [1,]  0.22024699 -0.010870387  0.023061513</span>
<span class="co">#&gt; [2,] -0.01087039  0.044112828 -0.009253676</span>
<span class="co">#&gt; [3,]  0.02306151 -0.009253676  0.245337212</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[4]]</span>
<span class="co">#&gt;             [,1]        [,2]        [,3]</span>
<span class="co">#&gt; [1,] 0.182328014 0.006104002 0.011988382</span>
<span class="co">#&gt; [2,] 0.006104002 0.042047254 0.005960284</span>
<span class="co">#&gt; [3,] 0.011988382 0.005960284 0.268431179</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[5]]</span>
<span class="co">#&gt;              [,1]         [,2]        [,3]</span>
<span class="co">#&gt; [1,]  0.220756776 -0.003540541 0.013888202</span>
<span class="co">#&gt; [2,] -0.003540541  0.042269002 0.001981767</span>
<span class="co">#&gt; [3,]  0.013888202  0.001981767 0.266068004</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[6]]</span>
<span class="co">#&gt;              [,1]        [,2]         [,3]</span>
<span class="co">#&gt; [1,]  0.198605502 -0.00774575  0.003669697</span>
<span class="co">#&gt; [2,] -0.007745750  0.04032928 -0.010448202</span>
<span class="co">#&gt; [3,]  0.003669697 -0.01044820  0.228310502</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(sim1<span class="op">$</span>sigmaList)
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt;           [,1]</span>
<span class="co">#&gt; [1,] 0.1011151</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt;           [,1]</span>
<span class="co">#&gt; [1,] 0.1053129</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[3]]</span>
<span class="co">#&gt;           [,1]</span>
<span class="co">#&gt; [1,] 0.1039805</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[4]]</span>
<span class="co">#&gt;           [,1]</span>
<span class="co">#&gt; [1,] 0.1048026</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[5]]</span>
<span class="co">#&gt;            [,1]</span>
<span class="co">#&gt; [1,] 0.09919539</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[6]]</span>
<span class="co">#&gt;           [,1]</span>
<span class="co">#&gt; [1,] 0.1049618</span></code></pre></div>
<p>It is also easy enough to create a plot to see what is going on with the simulation:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
p1 &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(sim1) ## This returns a ggplot2 object

## you can tweak the plot by the standard ggplot commands
p1 <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span>(<span class="st">"Time (hr)"</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span>(<span class="st">"Simulated Concentrations of TID steady state"</span>)</code></pre></div>
<p><img src="xgxr-nlmixr-ggpmx_files/figure-html/unnamed-chunk-19-1.png" width="100%"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># And put the same plot on a semi-log plot</span>
p1 <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span>(<span class="st">"Time (hr)"</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span>(<span class="st">"Simulated Concentrations of TID steady state"</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw"><a href="https://rdrr.io/pkg/xgxr/man/xgx_scale_y_log10.html">xgx_scale_y_log10</a></span>()</code></pre></div>
<p><img src="xgxr-nlmixr-ggpmx_files/figure-html/unnamed-chunk-19-2.png" width="100%"></p>
<p>For more complex simulations with variability you can also <a href="https://nlmixrdevelopment.github.io/RxODE/articles/RxODE-event-table.html#add-doses-and-samples-within-a-sampling-window">simulate dosing windows and sampling windows</a> and use any tool you want to summarize it in the way you wish.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#load-the-data">Load the data</a></li>
      <li>
<a href="#exploratory-analysis-using-ggplot-and-xgx-helper-functions">Exploratory analysis using ggplot and xgx helper functions</a><ul class="nav nav-pills nav-stacked">
<li><a href="#use-xgxr-for-simplified-concentration-over-time-colored-by-dose-mean---95-ci">Use xgxr for simplified concentration over time, colored by Dose, mean +/- 95% CI</a></li>
      <li><a href="#concentration-over-time-faceted-by-dose-mean---95-ci-overlaid-on-gray-spaghetti-plots">Concentration over time, faceted by Dose, mean +/- 95% CI, overlaid on gray spaghetti plots</a></li>
      <li><a href="#exploring-the-dose-linearity">Exploring the dose linearity</a></li>
      </ul>
</li>
      <li>
<a href="#exploring-covariates-in-the-dataset">Exploring Covariates in the dataset</a><ul class="nav nav-pills nav-stacked">
<li><a href="#summary-of-exploratory-analysis-findings">Summary of exploratory analysis findings</a></li>
      </ul>
</li>
      <li><a href="#fitting-the-data-with-nlmixr">Fitting the data with nlmixr</a></li>
      <li><a href="#model-diagnostics-with-ggpmx">Model Diagnostics with ggPMX</a></li>
      <li><a href="#simulation-of-a-new-scenario-with-rxode">Simulation of a new scenario with RxODE</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Matthew Fidler, Yuan Xiong, Rik Schoemaker, Justin Wilkins, Mirjam Trame, Richard Hooijmaijers, Teun Post, Wenping Wang.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
